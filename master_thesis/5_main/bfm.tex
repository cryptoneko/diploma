\section{Породжувальна модель обличчя}

За допомогою високоточного 3D сканеру
було зафіксовано $100$ чоловічих і $100$ жіночих облич.
Це люди віком від $8$ до $62$ років ($25$ в середньому),
вагою від $40$ до $123$ кілограмів ($66.5$ в середньому).

Щоб зважена сума облич теж була обличчям,
потрібно знайти відповідність між вершинами моделей різніх облич.
Наприклад, модель складається з впорядкованого набору вершин.
Тоді точка, яка відповідає за висоту горбинки на носі,
повинна бути на одній і тій самій позиції в масиві кожної моделі.
Для цього була використана модифікація
ітеративного алгоритму найближчих точок ICP \cite{AmbergRV07}.
Після цього достатньо відмітити опорні точки обличчя лише на одній моделі,
щоб вони були відомі на всіх інших,
у тому числі на похідних обличчях.

Розраховується середня модель обличчя як
середнє арифметичнє значення координат кожної вершини по всім моделям
\begin{equation*}
  \overline{f}_v
  = \frac{\sum\limits_{f \in F} f_v}{\left| F \right|},\qquad
  v \in V,
\end{equation*}
де $V$ --- множина вершин, $F$ --- множина облич,
$f_v$ --- координати вершини $v$ в обличчі $f$.
Середня модель теж є обличчям завдяки попередньому кроку співставлення вершин.

Останній етап, який нас цікавить,
це обробка даних за допомогою методу головних компонент \cite{Aivazyan:1989}.
На вході матриця, кожному стовбцю якої відповідає координата вершини,
а стрічці --- обличчя.
На перетині $f$ стрічки і $v_i$ стовбця знаходиться значення $i$ компоненти
координат вершини $v$ обличчя $f$
\begin{equation*}
  M = \begin{bmatrix}
    M_{v_x^1}^{f^1} & M_{v_y^1}^{f^1} & M_{v_z^1}^{f^1} & M_{v_x^2}^{f^1}
      & \dots                         & M_{v_y^m}^{f^1} & M_{v_z^m}^{f^1} \\
    M_{v_x^1}^{f^2} & M_{v_y^1}^{f^2} & M_{v_z^1}^{f^2} & M_{v_x^2}^{f^2}
      & \dots                         & M_{v_y^m}^{f^2} & M_{v_z^m}^{f^2} \\
    \vdots          & \vdots          & \vdots          & \vdots
      & \ddots                        & \vdots          & \vdots \\
    M_{v_x^1}^{f^n} & M_{v_y^1}^{f^n} & M_{v_z^1}^{f^n} & M_{v_x^2}^{f^n}
      & \dots                         & M_{v_y^m}^{f^n} & M_{v_z^m}^{f^n} \\
  \end{bmatrix}.
\end{equation*}
На виході маємо лінійне перетворення $L$ коваріаційної матриці $\widetilde{M}$,
яке робіть $L \cdot \widetilde{M} \cdot L^{-1}$ діагональною,
і дисперсії головних компонент.

Оскільки маємо головні компоненти,
нове обличчя отримується не як зважене середнє кількох облич,
а як сума середнього обличчя та вектору параметрів $x$
помноженого на матрицю $L$
\begin{equation*}
  M\left( x \right) = \overline{f} + x \cdot L.
\end{equation*}

Переваги головних компонент:
\begin{enumerate}
  \item для зменшення обчислювальних витрат можна обирати не всі параметри,
    а лише кілька перших,
    бо вони мають найбільшу дисперсію
    і несуть в собі більшу частину інформації;
  \item згідно з центральною граничною теоремою
    розподіл параметрів вважається нормальним,
      що зручно при моделюванні та обчисленнях:
  \begin{enumerate}
    \item фактично відсутні обмеження на параметри моделі на відміну від
      зваженого середнього, де сума параметрів повинна дорівнювати $1$;
    \item за побудовою випадкові величини мають нульове середнє значення
      та діагональню коваріаційну матрицю;
    \item якщо нормувати параметри (перенести їх дисперсію в матрицю $L$),
      отримаємо набір незалежно розподілених величин
      зі стандартним нормальним розподілом.
  \end{enumerate}
\end{enumerate}
